---
import Layout from '../layouts/Layout.astro';
import rewards from '../data/rewards.json';
import Badge from '../components/Badge.astro';
const base = import.meta.env.BASE_URL;

const CONTRIBUTING_URL =
  "https://github.com/MelissaSkywalkz/open-data-orbit/blob/main/CONTRIBUTING.md";

/** Enkel mapping för badge-stil (kan byggas ut senare) */
const pickVariant = (badge) => {
  const s = `${badge?.id ?? ''} ${badge?.name ?? ''}`.toLowerCase();
  if (s.includes('lab')) return { variant: 'terminal', icon: 'terminal' };
  if (s.includes('community') || s.includes('help')) return { variant: 'comms', icon: 'antenna' };
  if (s.includes('metadata')) return { variant: 'orbit', icon: 'orbit' };
  if (s.includes('bug')) return { variant: 'launch', icon: 'rocket' };
  return { variant: 'orbit', icon: 'orbit' };
};
---

<Layout title="Rewards" description="Badges och erkännande för contributions i Open Data Orbit">
  <!-- Hero -->
  <section class="rewards-hero">
    <h1 class="rewards-title">Mission Rewards</h1>
    <p class="rewards-lead">
      Rewards är ett sätt att synliggöra contributions i Open Data Orbit – att hjälpa andra,
      förbättra innehåll och bidra till ett öppnare dataekosystem i Sverige.
    </p>

    <div class="rewards-chips">
      <Badge label="STATUS: MVP" variant="terminal" icon="terminal" />
      <Badge label="AWARDS: MANUAL" variant="orbit" icon="orbit" />
      <Badge label="TRACK: DISCUSSIONS + PR" variant="comms" icon="antenna" />
    </div>
  </section>

  <!-- Info -->
  <section class="rewards-info card reward-info">
    <h2>Hur fungerar rewards?</h2>
    <p>
      I nuvarande version delas badges ut <strong>manuellt</strong> av moderatorer.
      Fokus ligger på kvalitet, hjälpsamhet och faktiska bidrag – inte mängd.
    </p>

    <ul class="rewards-bullets">
      <li>Hjälpsamma svar i GitHub Discussions</li>
      <li>Förbättringar av guider, resurser eller text</li>
      <li>Buggrapporter med tydliga exempel eller reproducerbara steg</li>
      <li>Bidrag till Labs, exempel eller prototyper</li>
    </ul>

    <p class="muted">
      Vill du bidra? Läs riktlinjerna i
      <a href={CONTRIBUTING_URL} target="_blank" rel="noopener">CONTRIBUTING.md</a>
      eller delta i communityn.
    </p>
  </section>

  <!-- Badges -->
  <section class="badges-grid">
    {rewards.map((b) => {
      const meta = pickVariant(b);
      return (
        <article class="card reward-card" key={b.id}>
          <div class="reward-top">
            <Badge label={b.name} variant={meta.variant} icon={meta.icon} size="md" />
          </div>

          <p class="reward-desc">{b.description}</p>

          <div class="reward-criteria">
            <span class="criteria-label">SIGNAL TO EARN</span>
            <p class="criteria-text">{b.criteria}</p>
          </div>
        </article>
      );
    })}
  </section>
</Layout>

<style>
/* Hero */
.rewards-hero{
  padding: var(--spacing-2xl) 0 var(--spacing-xl);
}

.rewards-title{
  margin-top: 0;
  font-family: var(--font-display);
  letter-spacing: 0.03em;
  text-shadow: 0 18px 70px rgba(88,166,255,0.18);
}

.rewards-lead{
  max-width: 70ch;
  color: rgba(230,237,243,0.80);
  margin-bottom: var(--spacing-lg);
  line-height: 1.75;
}

.rewards-chips{
  display:flex;
  flex-wrap: wrap;
  gap: 10px;
}

/* Info */
.reward-info{
  margin-top: var(--spacing-xl);
  padding: var(--spacing-lg);
  background:
    radial-gradient(ellipse 80% 120% at 20% 0%, rgba(31,111,235,0.14) 0%, transparent 55%),
    radial-gradient(ellipse 80% 120% at 80% 100%, rgba(44,83,100,0.16) 0%, transparent 55%),
    rgba(22,27,34,0.72);
  border: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  box-shadow: 0 20px 55px rgba(0,0,0,0.40);
}

.rewards-bullets{
  margin: var(--spacing-md) 0;
  padding-left: 1.2em;
}

.rewards-bullets li{
  margin-bottom: 8px;
  color: rgba(230,237,243,0.78);
}

.muted{
  color: rgba(230,237,243,0.60);
}

/* Grid */
.badges-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: var(--spacing-lg);
  margin-top: var(--spacing-xl);
  padding-bottom: var(--spacing-2xl);
}

.reward-card{
  padding: var(--spacing-lg);
  background: rgba(22,27,34,0.70);
  border: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  position: relative;
  overflow: hidden;
}

.reward-card::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: linear-gradient(
    120deg,
    rgba(31,111,235,0.10) 0%,
    rgba(13,17,23,0.00) 55%,
    rgba(44,83,100,0.10) 100%
  );
  opacity: .9;
}

.reward-card > *{ position: relative; z-index: 1; }

.reward-top{
  margin-bottom: var(--spacing-md);
}

.reward-desc{
  margin: 0 0 var(--spacing-lg);
  color: rgba(230,237,243,0.78);
  line-height: 1.7;
}

.reward-criteria{
  border-top: 1px solid rgba(255,255,255,0.07);
  padding-top: var(--spacing-md);
}

.criteria-label{
  display:inline-block;
  font-family: var(--font-mono);
  font-weight: 900;
  letter-spacing: 0.12em;
  font-size: 0.72rem;
  color: rgba(88,166,255,0.85);
  margin-bottom: 8px;
}

.criteria-text{
  margin: 0;
  color: rgba(230,237,243,0.74);
  line-height: 1.7;
}
</style>
